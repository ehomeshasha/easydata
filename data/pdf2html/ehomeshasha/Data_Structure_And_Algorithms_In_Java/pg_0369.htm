<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0052)http://www.verypdf.com/ -->
<html>
<head>
<title>pg_0369</title>

<style>
<!-- 
select {font-size:12px;}
A:link {text-decoration: none; color: blue}
A:visited {text-decoration: none; color: purple}
A:active {text-decoration: red}
A:hover {text-decoration: underline; color:red}
-->
</style>
<script TYPE="text/javascript"> 
<!-- hide 
function killerrors()
{ 
return true; 
} 
window.onerror = killerrors; 
// --> 
</script>
<style type="text/css">
<!--
.ft0{font-style:normal;font-weight:normal;font-size:16px;font-family:Times New Roman;color:#000000;}
.ft1{font-style:normal;font-weight:normal;font-size:13px;font-family:Arial;color:#010100;}
.ft2{font-style:normal;font-weight:normal;font-size:13px;font-family:Arial;color:#000000;}
.ft3{font-style:normal;font-weight:bold;font-size:13px;font-family:Arial;color:#010100;}
.ft4{font-style:normal;font-weight:normal;font-size:13px;font-family:Times New Roman;color:#000000;}
.ft5{font-style:normal;font-weight:bold;font-size:16px;font-family:Arial;color:#010100;}
.ft6{font-style:normal;font-weight:normal;font-size:10px;font-family:Arial;color:#ff00ff;}
.ft7{font-style:normal;font-weight:normal;font-size:13px;font-family:Times New Roman;color:#010100;}
-->
</style>
</head>
<body vlink="#FFFFFF" link="#FFFFFF" bgcolor="#ffffff">

<script TYPE="text/javascript">
var currentpos,timer; 
function initialize() 
{ 
timer=setInterval("scrollwindow()",10);
} 
function sc(){
clearInterval(timer); 
}
function scrollwindow() 
{ 
currentpos=document.body.scrollTop; 
window.scroll(0,++currentpos); 
if (currentpos != document.body.scrollTop) 
sc();
} 
document.onmousedown=sc
document.ondblclick=initialize
</script>
<div style="position:absolute;top:0;left:0"><img width="826" height="1169" src="pg_0369.jpg" ALT=""></div>
<div style="position:absolute;top:1102;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:1102;left:391"><span class="ft0"> - 369 -</span></div>
<div style="position:absolute;top:102;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:81;left:90"><span class="ft1"> In the second phase, two sorted blocks are read, merged into a two-block sequence, and </span></div>
<div style="position:absolute;top:97;left:90"><span class="ft1">written back to disk. This continues until all pairs of blocks have been merged. Next each </span></div>
<div style="position:absolute;top:112;left:90"><span class="ft1">pair of 2-block sequences is merged into a 4-block sequence. Each time the size of the </span></div>
<div style="position:absolute;top:128;left:90"><span class="ft1">sorted sequences doubles, until the entire file is sorted.</span></div>
<div style="position:absolute;top:125;left:429"><span class="ft0"> </span></div>
<div style="position:absolute;top:102;left:640"><span class="ft0">  </span></div>
<div style="position:absolute;top:129;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:148;left:80"><span class="ft0"> </span></div>
<div style="position:absolute;top:185;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:164;left:90"><span class="ft1"> Figure 10.22 </span></div>
<div style="position:absolute;top:164;left:172"><span class="ft2">shows the mergesort process on an external file. The file consists of four </span></div>
<div style="position:absolute;top:180;left:90"><span class="ft2">blocks of four records each, for a total of 16 records. Only three blocks can fit in internal </span></div>
<div style="position:absolute;top:196;left:90"><span class="ft2">memory. (Of course all these sizes would be much larger in a real situation.) </span></div>
<div style="position:absolute;top:196;left:562"><span class="ft1">Figure </span></div>
<div style="position:absolute;top:212;left:90"><span class="ft1">10.22-a </span></div>
<div style="position:absolute;top:212;left:141"><span class="ft2">shows the file before sorting; the number in each record is its key value.</span></div>
<div style="position:absolute;top:209;left:582"><span class="ft0"> </span></div>
<div style="position:absolute;top:185;left:640"><span class="ft0">  </span></div>
<div style="position:absolute;top:212;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:231;left:80"><span class="ft0"> </span></div>
<div style="position:absolute;top:365;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:488;left:407"><span class="ft0">  </span></div>
<div style="position:absolute;top:365;left:640"><span class="ft0">  </span></div>
<div style="position:absolute;top:488;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:507;left:80"><span class="ft0"> </span></div>
<div style="position:absolute;top:523;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:523;left:136"><span class="ft3"> Figure 10.22:  Mergesort on an external file</span></div>
<div style="position:absolute;top:520;left:405"><span class="ft0"> </span></div>
<div style="position:absolute;top:523;left:640"><span class="ft0">  </span></div>
<div style="position:absolute;top:546;left:80"><span class="ft0"> </span></div>
<div style="position:absolute;top:544;left:136"><span class="ft4">  </span></div>
<div style="position:absolute;top:544;left:640"><span class="ft4">  </span></div>
<div style="position:absolute;top:546;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:565;left:80"><span class="ft0"> </span></div>
<div style="position:absolute;top:580;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:580;left:90"><span class="ft5"> Internal Sort of Blocks</span></div>
<div style="position:absolute;top:580;left:268"><span class="ft0"> </span></div>
<div style="position:absolute;top:580;left:640"><span class="ft0">  </span></div>
<div style="position:absolute;top:584;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:603;left:80"><span class="ft0"> </span></div>
<div style="position:absolute;top:649;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:619;left:90"><span class="ft1"> In the first phase all the blocks in the file are sorted internally. This is done by reading the </span></div>
<div style="position:absolute;top:635;left:90"><span class="ft1">block into memory and sorting it with any appropriate internal sorting algorithm, such as </span></div>
<div style="position:absolute;top:651;left:90"><span class="ft1">Quicksort (or for smaller numbers of records, shellsort or insertion sort). The result of </span></div>
<div style="position:absolute;top:667;left:90"><span class="ft1">sorting the blocks internally is shown in Figure 10.22-b</span></div>
<div style="position:absolute;top:667;left:425"><span class="ft2">. The dotted lines in the figure </span></div>
<div style="position:absolute;top:683;left:90"><span class="ft2">separate sorted records; solid lines separate unsorted records.</span></div>
<div style="position:absolute;top:680;left:476"><span class="ft0"> </span></div>
<div style="position:absolute;top:649;left:640"><span class="ft0">  </span></div>
<div style="position:absolute;top:683;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:702;left:80"><span class="ft0"> </span></div>
<div style="position:absolute;top:724;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:718;left:90"><span class="ft1"> A second file may be used to hold the sorted blocks, and we assume that availability of </span></div>
<div style="position:absolute;top:734;left:90"><span class="ft1">external storage is not a problem. It's often desirable to avoid modifying the original file.</span></div>
<div style="position:absolute;top:731;left:626"><span class="ft0">   </span></div>
<div style="position:absolute;top:734;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:753;left:80"><span class="ft0"> </span></div>
<div style="position:absolute;top:769;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:769;left:90"><span class="ft5"> Merging</span></div>
<div style="position:absolute;top:769;left:155"><span class="ft0"> </span></div>
<div style="position:absolute;top:769;left:640"><span class="ft0">  </span></div>
<div style="position:absolute;top:772;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:792;left:80"><span class="ft0"> </span></div>
<div style="position:absolute;top:837;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:807;left:90"><span class="ft1"> In the second phase we want to merge the sorted blocks. In the first pass we merge </span></div>
<div style="position:absolute;top:823;left:90"><span class="ft1">every pair of blocks into a sorted 2-block sequence. Thus the two blocks 2-9-11-14 and </span></div>
<div style="position:absolute;top:839;left:90"><span class="ft1">4-12-13-16 are merged into 2-4-9-11-12-13-14-16. Also, 3-5-10-15 and 1-6-7-8 are </span></div>
<div style="position:absolute;top:855;left:90"><span class="ft1">merged into 1-3-5-6-7-8-10-15. The result is shown in Figure 10.22-c</span></div>
<div style="position:absolute;top:855;left:512"><span class="ft2">. A third file is </span></div>
<div style="position:absolute;top:871;left:90"><span class="ft2">necessary to hold the result of this merge step.</span></div>
<div style="position:absolute;top:868;left:378"><span class="ft0"> </span></div>
<div style="position:absolute;top:837;left:640"><span class="ft0">  </span></div>
<div style="position:absolute;top:872;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:891;left:80"><span class="ft0"> </span></div>
<div style="position:absolute;top:928;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:907;left:90"><span class="ft1"> In the second pass, the two 8-record sequences are merged into a 16-record sequence, </span></div>
<div style="position:absolute;top:922;left:90"><span class="ft1">and the sort is complete. Of course more merge steps would be required to sort larger </span></div>
<div style="position:absolute;top:938;left:90"><span class="ft1">files; the number of such steps is proportional to log</span></div>
<div style="position:absolute;top:941;left:408"><span class="ft6">2</span></div>
<div style="position:absolute;top:938;left:413"><span class="ft1">N. The merge steps can alternate </span></div>
<div style="position:absolute;top:954;left:90"><span class="ft1">between two files.</span></div>
<div style="position:absolute;top:951;left:201"><span class="ft0"> </span></div>
<div style="position:absolute;top:928;left:640"><span class="ft0">  </span></div>
<div style="position:absolute;top:955;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:974;left:80"><span class="ft0"> </span></div>
<div style="position:absolute;top:989;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:989;left:90"><span class="ft5"> Internal Arrays</span></div>
<div style="position:absolute;top:989;left:208"><span class="ft0"> </span></div>
<div style="position:absolute;top:989;left:640"><span class="ft0">  </span></div>
<div style="position:absolute;top:993;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:1012;left:80"><span class="ft0"> </span></div>
<div style="position:absolute;top:1043;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:1028;left:90"><span class="ft1"> Because the computer's internal memory has room for only three blocks, the merging </span></div>
<div style="position:absolute;top:1044;left:90"><span class="ft1">process must take place in stages. Let's say there are three arrays, called </span></div>
<div style="position:absolute;top:1044;left:547"><span class="ft7">arr1</span></div>
<div style="position:absolute;top:1044;left:580"><span class="ft1">, </span></div>
<div style="position:absolute;top:1044;left:588"><span class="ft7">arr2</span></div>
<div style="position:absolute;top:1044;left:621"><span class="ft1">, </span></div>
<div style="position:absolute;top:1062;left:90"><span class="ft1">and </span></div>
<div style="position:absolute;top:1062;left:117"><span class="ft7">arr3</span></div>
<div style="position:absolute;top:1062;left:151"><span class="ft1">, each of which can hold a block.</span></div>
<div style="position:absolute;top:1059;left:351"><span class="ft0"> </span></div>
<div style="position:absolute;top:1043;left:640"><span class="ft0">  </span></div>
<div style="position:absolute;top:1062;left:79"><span class="ft0"> </span></div>
<script TYPE="text/javascript">
			var currentZoom = parent.ltop.currentZoom;
			if(currentZoom != undefined)
				document.body.style.zoom=currentZoom/100;
			</script>
</body>
</html>