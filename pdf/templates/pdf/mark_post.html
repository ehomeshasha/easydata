<div>
{% load custom_tags %}
<textarea id="mark_editor" name="content"></textarea>
<input class="upload_file" id="upload_image" type="file" style="display:none;" data-type="image" data-module="code_mark_image" />
<input class="upload_file" id="upload_file" type="file" style="display:none;" data-type="file" data-module="code_mark_file" />
</div>
<script type="text/javascript">
tinymce.init({
	relative_urls : false,
	remove_script_host : false,
	convert_urls : true,
	language:'{{ CONSTANT.tinymce.language|get:LANGUAGE_CODE }}',
	menubar:false,
    statusbar: false,
    selector: '#mark_editor',
    plugins: ["image", "emoticons", "textcolor", "link", "fileupload", "highlight_text"],
    toolbar: " emoticons | fontsizeselect | bold italic underline forecolor backcolor highlight_text | link image fileupload | alignleft aligncenter alignright | undo redo ",
    file_browser_callback: function(field_name, url, type, win) { 
    	if(type == 'image') {
    		$("#upload_image").attr("data-inputid", field_name)
    		$('#upload_image').click();
    	} else if(type == 'file') {
    		$("#upload_file").attr("data-inputid", field_name)
    		$('#upload_file').click();
    	}
         
    },
    setup: function(editor) {
    	
    }
});
</script>
{% block modal_form_javascript %}
<script type="text/javascript">
$("#modal_form").submit(function(){
	var fd = $(this).serialize();
	$.ajax({
		url: "{{ request.get_full_path }}",
		type: "POST",
		data: fd,
		error: function(){alert('try it again');return false;},
		success: function(data) {
			$(".mark_nav_anchor_view_line").trigger('click');
		}
	});
	return false;
});
</script>
{% endblock %}