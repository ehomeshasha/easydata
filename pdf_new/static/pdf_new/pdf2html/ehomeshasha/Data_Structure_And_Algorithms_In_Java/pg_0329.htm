<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0052)http://www.verypdf.com/ -->
<html>
<head>
<title>pg_0329</title>

<style>
<!-- 
select {font-size:12px;}
A:link {text-decoration: none; color: blue}
A:visited {text-decoration: none; color: purple}
A:active {text-decoration: red}
A:hover {text-decoration: underline; color:red}
-->
</style>
<script TYPE="text/javascript"> 
<!-- hide 
function killerrors()
{ 
return true; 
} 
window.onerror = killerrors; 
// --> 
</script>
<style type="text/css">
<!--
.ft0{font-style:normal;font-weight:normal;font-size:16px;font-family:Times New Roman;color:#000000;}
.ft1{font-style:normal;font-weight:bold;font-size:13px;font-family:Arial;color:#010100;}
.ft2{font-style:normal;font-weight:normal;font-size:13px;font-family:Arial;color:#010100;}
.ft3{font-style:normal;font-weight:normal;font-size:13px;font-family:Times New Roman;color:#000000;}
.ft4{font-style:normal;font-weight:normal;font-size:13px;font-family:Times New Roman;color:#010100;}
.ft5{font-style:italic;font-weight:normal;font-size:13px;font-family:Arial;color:#010100;}
.ft6{font-style:normal;font-weight:normal;font-size:13px;font-family:Arial;color:#000000;}
.ft7{font-style:normal;font-weight:bold;font-size:16px;font-family:Arial;color:#010100;}
-->
</style>
</head>
<body vlink="#FFFFFF" link="#FFFFFF" bgcolor="#ffffff">

<script TYPE="text/javascript">
var currentpos,timer; 
function initialize() 
{ 
timer=setInterval("scrollwindow()",10);
} 
function sc(){
clearInterval(timer); 
}
function scrollwindow() 
{ 
currentpos=document.body.scrollTop; 
window.scroll(0,++currentpos); 
if (currentpos != document.body.scrollTop) 
sc();
} 
document.onmousedown=sc
document.ondblclick=initialize
</script>
<div style="position:absolute;top:0;left:0"><img width="826" height="1169" src="pg_0329.jpg" ALT=""></div>
<div style="position:absolute;top:1102;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:1102;left:391"><span class="ft0"> - 329 -</span></div>
<div style="position:absolute;top:205;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:334;left:308"><span class="ft0">  </span></div>
<div style="position:absolute;top:205;left:640"><span class="ft0">  </span></div>
<div style="position:absolute;top:334;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:353;left:80"><span class="ft0"> </span></div>
<div style="position:absolute;top:368;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:369;left:136"><span class="ft1"> Figure 9.15:  Possibility 3: P is red and X is an inside grandchild</span></div>
<div style="position:absolute;top:366;left:531"><span class="ft0"> </span></div>
<div style="position:absolute;top:368;left:640"><span class="ft0">  </span></div>
<div style="position:absolute;top:391;left:80"><span class="ft0"> </span></div>
<div style="position:absolute;top:389;left:136"><span class="ft3">  </span></div>
<div style="position:absolute;top:389;left:640"><span class="ft3">  </span></div>
<div style="position:absolute;top:391;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:410;left:80"><span class="ft0"> </span></div>
<div style="position:absolute;top:433;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:426;left:90"><span class="ft2"> Note that the 18 node is an inside grandchild. It and its parent are both red, so again you </span></div>
<div style="position:absolute;top:442;left:90"><span class="ft2">see the error message </span></div>
<div style="position:absolute;top:442;left:233"><span class="ft4">Error: parent and child both red</span></div>
<div style="position:absolute;top:442;left:500"><span class="ft2">.</span></div>
<div style="position:absolute;top:439;left:504"><span class="ft0"> </span></div>
<div style="position:absolute;top:433;left:640"><span class="ft0">  </span></div>
<div style="position:absolute;top:443;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:462;left:80"><span class="ft0"> </span></div>
<div style="position:absolute;top:500;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:478;left:90"><span class="ft2"> Fixing this arrangement is slightly more complicated. If we try to rotate right with the </span></div>
<div style="position:absolute;top:494;left:90"><span class="ft2">grandparent node G (25) at the top, as we did in Possibility 2, the inside grandchild X (18) </span></div>
<div style="position:absolute;top:510;left:90"><span class="ft2">moves across rather than up, so the tree is no more balanced than before. (Try this, then </span></div>
<div style="position:absolute;top:526;left:90"><span class="ft2">rotate back, with 12 at the top, to restore it.) A different solution is needed.</span></div>
<div style="position:absolute;top:523;left:545"><span class="ft0"> </span></div>
<div style="position:absolute;top:500;left:640"><span class="ft0">  </span></div>
<div style="position:absolute;top:526;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:545;left:80"><span class="ft0"> </span></div>
<div style="position:absolute;top:583;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:561;left:90"><span class="ft2"> The trick when X is an inside grandchild is to perform two rotations rather than one. The </span></div>
<div style="position:absolute;top:577;left:90"><span class="ft2">first changes X from an inside grandchild to an outside grandchild, as shown in Figure </span></div>
<div style="position:absolute;top:593;left:90"><span class="ft2">9.15b</span></div>
<div style="position:absolute;top:593;left:125"><span class="ft6">. Now the situation is similar to Possibility 1, and we can apply the same rotation, </span></div>
<div style="position:absolute;top:609;left:90"><span class="ft6">with the grandparent at the top, as we did before. The result is shown in </span></div>
<div style="position:absolute;top:609;left:534"><span class="ft2">Figure 9.15c</span></div>
<div style="position:absolute;top:609;left:612"><span class="ft6"> .</span></div>
<div style="position:absolute;top:606;left:615"><span class="ft0"> </span></div>
<div style="position:absolute;top:583;left:640"><span class="ft0">  </span></div>
<div style="position:absolute;top:609;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:629;left:80"><span class="ft0"> </span></div>
<div style="position:absolute;top:658;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:644;left:90"><span class="ft2"> We must also recolor the nodes. We do this before doing any rotations. (This order </span></div>
<div style="position:absolute;top:660;left:90"><span class="ft2">doesn't really matter, but if we wait until after the rotations to recolor the nodes, it's hard </span></div>
<div style="position:absolute;top:676;left:90"><span class="ft2">to know what to call them.) The steps are</span></div>
<div style="position:absolute;top:673;left:343"><span class="ft0"> </span></div>
<div style="position:absolute;top:658;left:640"><span class="ft0">  </span></div>
<div style="position:absolute;top:677;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:696;left:80"><span class="ft0"> </span></div>
<div style="position:absolute;top:711;left:79"><span class="ft0">  </span></div>
<div style="position:absolute;top:712;left:90"><span class="ft2"> 1.</span></div>
<div style="position:absolute;top:709;left:102"><span class="ft0">  </span></div>
<div style="position:absolute;top:712;left:113"><span class="ft2">Switch the color of X's grandparent (25 in this example).</span></div>
<div style="position:absolute;top:709;left:457"><span class="ft0"> </span></div>
<div style="position:absolute;top:711;left:640"><span class="ft0">  </span></div>
<div style="position:absolute;top:715;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:734;left:80"><span class="ft0"> </span></div>
<div style="position:absolute;top:749;left:79"><span class="ft0">  </span></div>
<div style="position:absolute;top:750;left:90"><span class="ft2"> 2.</span></div>
<div style="position:absolute;top:747;left:102"><span class="ft0">  </span></div>
<div style="position:absolute;top:750;left:113"><span class="ft2">Switch the color of X (not its parent; X is 18 here).</span></div>
<div style="position:absolute;top:747;left:419"><span class="ft0"> </span></div>
<div style="position:absolute;top:749;left:640"><span class="ft0">  </span></div>
<div style="position:absolute;top:753;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:772;left:80"><span class="ft0"> </span></div>
<div style="position:absolute;top:794;left:79"><span class="ft0">  </span></div>
<div style="position:absolute;top:788;left:90"><span class="ft2"> 3.</span></div>
<div style="position:absolute;top:785;left:102"><span class="ft0">  </span></div>
<div style="position:absolute;top:788;left:113"><span class="ft2">Rotate with X's parent P at the top (not the grandparent; the parent is 12), in the </span></div>
<div style="position:absolute;top:804;left:113"><span class="ft2">direction that raises X (a left rotation in this example).</span></div>
<div style="position:absolute;top:801;left:441"><span class="ft0"> </span></div>
<div style="position:absolute;top:794;left:640"><span class="ft0">  </span></div>
<div style="position:absolute;top:804;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:823;left:80"><span class="ft0"> </span></div>
<div style="position:absolute;top:845;left:79"><span class="ft0">  </span></div>
<div style="position:absolute;top:839;left:90"><span class="ft2"> 4.</span></div>
<div style="position:absolute;top:836;left:102"><span class="ft0">  </span></div>
<div style="position:absolute;top:839;left:113"><span class="ft2">Rotate again with X's grandparent (25) at the top, in the direction that raises X (a right </span></div>
<div style="position:absolute;top:855;left:113"><span class="ft2">rotation).</span></div>
<div style="position:absolute;top:852;left:168"><span class="ft0"> </span></div>
<div style="position:absolute;top:845;left:640"><span class="ft0">  </span></div>
<div style="position:absolute;top:855;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:874;left:80"><span class="ft0"> </span></div>
<div style="position:absolute;top:904;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:890;left:90"><span class="ft2"> This restores the tree to red-black correctness and also balances it (as much as </span></div>
<div style="position:absolute;top:906;left:90"><span class="ft2">possible). As with Possibility 2, there is an analogous case in which P is the right child of </span></div>
<div style="position:absolute;top:922;left:90"><span class="ft2">G rather than the left.</span></div>
<div style="position:absolute;top:919;left:221"><span class="ft0"> </span></div>
<div style="position:absolute;top:904;left:640"><span class="ft0">  </span></div>
<div style="position:absolute;top:922;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:942;left:80"><span class="ft0"> </span></div>
<div style="position:absolute;top:957;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:957;left:90"><span class="ft7"> What About Other Possibilities.</span></div>
<div style="position:absolute;top:957;left:345"><span class="ft0"> </span></div>
<div style="position:absolute;top:957;left:640"><span class="ft0">  </span></div>
<div style="position:absolute;top:961;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:980;left:80"><span class="ft0"> </span></div>
<div style="position:absolute;top:995;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:996;left:90"><span class="ft2"> Do the three Post-Insertion Possibilities we just discussed really cover all situations.</span></div>
<div style="position:absolute;top:993;left:608"><span class="ft0">   </span></div>
<div style="position:absolute;top:999;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:1018;left:80"><span class="ft0"> </span></div>
<div style="position:absolute;top:1048;left:79"><span class="ft0"> </span></div>
<div style="position:absolute;top:1034;left:90"><span class="ft2"> Suppose, for example, that X has a sibling S; the other child of P. This might complicate </span></div>
<div style="position:absolute;top:1050;left:90"><span class="ft2">the rotations necessary to insert X. But if P is  black, there's no problem inserting X (that's </span></div>
<div style="position:absolute;top:1066;left:90"><span class="ft2">Possibility 1). If P is red, then both its children must be black (to avoid violating Rule 3). It </span></div>
<div style="position:absolute;top:1048;left:640"><span class="ft0"> </span></div>
<script TYPE="text/javascript">
			var currentZoom = parent.ltop.currentZoom;
			if(currentZoom != undefined)
				document.body.style.zoom=currentZoom/100;
			</script>
</body>
</html>